<div class="container-fluid">
  <br>
  <div *ngIf="blnEcnSaved" class="alert alert-success" role="alert">
    <p> The ECN has been successfully saved to the database </p>
  </div>
  <div class="card">

    <div class="card-header">
      <span class="text-info"> {{pageTitle}} </span>
    </div>

    <div class="card-block " style="font-size: 75%;">

      <div>

        <form [formGroup]='newEcnForm'>

          <!--ECN No-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="ecnNoId">No.: </label>
            <div class="col-sm-4 " [ngClass]="{'has-danger': ecnErrorMessage, 'has-success' : isEcnValid }">

              <input class="form-control form-control-lg form-control-success" type="text" placeholder="Required (min. 7 characters)" id="ecnNoId"
                formControlName="ecnNo">


              <small class="form-text" *ngIf="ecnErrorMessage">
               <ul class="fa-ul ">
              <li  class="text-muted text-danger"
              *ngFor='let error of ecnErrorMessage'>
                  <i class="fa-li fa fa-exclamation-circle" aria-hidden="true"></i> {{error}}
              </li>
               </ul>
            </small>

            </div>

          </div>

          <!--Title-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="titleId">Title: </label>
            <div class="col-sm-4 " [ngClass]="{'has-danger':(newEcnForm.get('title').touched || newEcnForm.get('title').dirty) && !newEcnForm.get('title').valid, 'has-success': (newEcnForm.get('title').valid && newEcnForm.get('title').dirty )}">
              <input class="form-control form-control-lg form-control-success" type="text" placeholder="Required" id="titleId"
                formControlName="title">


            </div>
            <div class="col-sm-6 col-form-label">
              <span *ngIf="(newEcnForm.get('title').touched) && newEcnForm.get('title').errors">
                <small class="form-text text-muted text-danger" *ngIf="newEcnForm.get('title').errors.required" >Please enter a valid Title</small>
              </span>
            </div>
          </div>

          <!--Priority-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="priorityId">Priority: </label>
            <div class="col-sm-4 " [ngClass]="{'has-danger':priorityErrorMessage, 'has-success': isPriorityValid}">

              <input class="form-control form-control-lg form-control-success" type="number" min="1" placeholder="1-10" id="priorityId"
                formControlName="priority">

              <small class="form-text" *ngIf="priorityErrorMessage">
               <ul class="fa-ul">
              <li  class="text-muted text-danger "
              *ngFor='let error of priorityErrorMessage'>
                  <i class="fa-li fa fa-exclamation-circle" aria-hidden="true"></i> {{error}}
              </li>
               </ul>
            </small>

            </div>


          </div>

          <!--ECN Originator-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="dropdownMenuButton">Originator: </label>
            <div class="dropdown col-sm-4 ">

              <select class="form-control form-control-lg" formControlName="originatorId">
                    <option *ngFor='let user of userList'  [value]=user.Key>
                      {{user.Value}} - {{user.Key}}
                    </option>
                  </select>

            </div>
          </div>

          <!--Current Worker-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="dropdownMenuButton">Resource: </label>
            <div class="dropdown col-sm-4 ">

              <select class="form-control form-control-lg" formControlName="currentWorkerId">
                    <option ></option>
                    <option *ngFor='let user of userList' [value]=user.Key>
                       {{user.Value}} - {{user.Key}}
                    </option>
                  </select>

            </div>
          </div>

          <!--Project-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="dropdownMenuButton">Project: </label>
            <div class="dropdown col-sm-4 ">

              <select class="form-control form-control-lg" formControlName="projectId">
                  <option *ngFor='let project of projectList'  [value]=project.Key>
                  {{project.Value}} - {{project.Key}}
                  </option>
                </select>

            </div>
          </div>


          <!--Status-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="statusId">Status: </label>
            <div class="col-sm-4 " [ngClass]="{'has-danger':(newEcnForm.get('status').touched || newEcnForm.get('status').dirty) && !newEcnForm.get('status').valid, 'has-success': (newEcnForm.get('status').valid && newEcnForm.get('status').dirty )}">
              <input class="form-control form-control-lg form-control-success" type="text" placeholder="Required (min. 3 characters)" id="statusId"
                formControlName="status">


            </div>
            <div class="col-sm-6 col-form-label">
              <span *ngIf="(newEcnForm.get('status').touched) && newEcnForm.get('status').errors">
                <small class="form-text text-muted text-danger" *ngIf="newEcnForm.get('status').errors.required" >Please enter a valid status</small>
                <small class="form-text text-muted text-danger" *ngIf="newEcnForm.get('status').errors?.minlength" >Status should be a minimum of 3 characters.</small>
              </span>
            </div>
          </div>

          <!--Status Date-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="statusDateId">Status Date: </label>
            <div class="col-sm-4 " [ngClass]="{'has-danger':(newEcnForm.get('statusDate').touched || newEcnForm.get('statusDate').dirty) && !newEcnForm.get('statusDate').valid, 'has-success': (newEcnForm.get('statusDate').valid && newEcnForm.get('statusDate').dirty )}">
              <input class="form-control form-control-lg form-control-success" type="text" placeholder="Required" id="statusDateId" formControlName="statusDate">


            </div>
            <div class="col-sm-6 col-form-label">
              <span *ngIf="(newEcnForm.get('statusDate').touched) && newEcnForm.get('statusDate').errors">
                <small class="form-text text-muted text-danger" *ngIf="newEcnForm.get('statusDate').errors.required" >Please enter a valid status date</small>
              </span>
            </div>
          </div>

          <!--Description-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="descriptionId">Description: </label>
            <div class="col-sm-4 ">

              <textarea class="form-control form-control-lg" rows="4" id="descriptionId" formControlName="description"> </textarea>

            </div>
            <div class="col-sm-6 col-form-label">
              <small class="form-text text-muted text-danger" *ngIf="newEcnForm.get('description').touched && newEcnForm.get('description').errors"> Please enter a valid description</small>
            </div>
          </div>

          <!--Tags-->
          <div class="row form-group">
            <label class=" col-sm-2 col-form-label text-right" for="tagsId">Tags: </label>
            <div class="col-sm-4 ">

              <input type="text" class="form-control form-control-lg" id="tagsId" formControlName="tags" placeholder="comma separated">

            </div>
            <div class="col-sm-6 col-form-label">
              <small class="form-text text-muted text-danger" *ngIf="newEcnForm.get('tags').touched && newEcnForm.get('tags').errors"> Please enter valid tags</small>
            </div>
          </div>

        </form>
      </div>
    </div>



    <div class="card-footer">
      <div class="row">
        <div>
          <input type="button" class="btn btn-outline-primary " value="Save" (click)="saveEcn()" [disabled]='!newEcnForm.valid'>

          <input type="button" class="btn btn-outline-primary" value="Back" [routerLink]="['/ecns']" />

        </div>



      </div>
    </div>

  </div>

</div>

<!--<br> formValue = {{newEcnForm.value | json}}-->
<!--<br>
{{ecnErrorMessage}}-->
